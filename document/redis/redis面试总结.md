# Redis理论总结

## 1. Reids理论总结

### 1.1 Reids有哪些数据结构
`string`、`Hash`、`List`、`Set`、`SortedSet`（有序集合）。除此之外你还可以说你是`Redis`中高级用户，还需要加上下面几种数据结构：`HyperLogLog`、`Geo`、`Pub/Sub`。

如果你说还玩过`Redis Module`，像`BloomFilter`，`RedisSearch`，`Redis-ML`，面试官得眼睛就开始发亮了。

应用场景说明：
* String：缓存、计数器、分布式锁等；
* List：链表、队列、微博关注人时间轴列表等；
* Hash：用户信息、Hash 表等；
* Set：去重、赞、踩、共同好友等；
* Zset：访问量排行榜、点击量排行榜等；

### 1.2 Redis为啥这么快?
主要有以下几点：
* 纯内存操作，读取的时候不需要进行磁盘的I/O；
* 单线程，保证了系统没有线程的上线文切换；
* 高效的数据结构；
* 合理的数据编码；

### 1.3 Redis数据的淘汰策略
volatile-lru：从已经设置过期时间的数据集中，挑选最近最少使用的数据淘汰；
volatile-ttl：从已经设置过期时间的数据集中，挑选即将要过期的数据淘汰；
volatile-random：从已经设置过期时间的数据集中，随机挑选数据淘汰。
allkeys-lru：从所有的数据集中，挑选最近最少使用的数据淘汰；
allkeys-random：从所有的数据集中，随机挑选数据淘汰；
no-envication：禁止淘汰数据；

### 1.4 如何保证缓存与数据库数据一致性

#### 问题1：
先修改数据库，再删除缓存。如果删除缓存失败了，那么会导致数据库中是新数据，缓存中是旧数据，数据就出现了不一致。

**解决思路：** 先删除缓存，再修改数据库。如果数据库修改失败了，那么数据库中是旧数据，缓存中是空的，那么数据不会不一致。

因为读的时候缓存没有，则读数据库中旧数据，然后更新到缓存中。

